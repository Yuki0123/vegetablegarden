{% extends 'base.html' %}
{% load tags %}

{% block content %}

<p class="uk-h4"><i uk-icon="file-edit"></i>&nbsp;最新のお世話記録</p>

{% for cropmanagement in cropmanagements %}
<a href="{% url 'vegetablegarden:cropmanagement_list' cropmanagement.growing_crop.pk %}" class="uk-display-block uk-link-toggle">
    <div class="uk-animation-toggle" tabindex="0" >
    <div class="uk-grid-match uk-animation-fade" uk-grid>
        <div class="uk-width-1-6@s">
            <div class="">{{cropmanagement.date|date:"Y-m-d"}}</div>
            <div><span class="uk-badge">{{cropmanagement.growing_crop.area|truncatechars:8}}</span></div>
        </div>
        <div class="uk-width-1-4@s">
            <div class="uk-width-1-1">
                <div class="uk-width-auto"><span class="uk-text-bold">{{cropmanagement.growing_crop.vegetable}}</span></div>
                <div class="uk-width-auto"><span class="uk-text-meta">{{cropmanagement.growing_crop.variety|truncatechars:20}}</span></div>
            </div>
            
        </div>
        <div class="uk-width-expand@s">
            <div class="" uk-grid>
                {% if cropmanagement.image %}
                <div class="uk-width-2-3">{{cropmanagement.text|truncatechars:50|linebreaksbr}}</div>
                <div class="uk-width-auto">
                    <img src="{{ cropmanagement.image.url }}" width="100">
                </div>
                {% else %}
                <div class="uk-width-1-1">{{cropmanagement.text|truncatechars:50|linebreaksbr}}</div>
                {% endif %}

            </div>
        </div>
    </div>
    </div>
</a>
{% if not forloop.last %}<hr class="uk-devider">{% endif %}
{% endfor %}

{% if growingcrop_list.count > 0 %}
<hr class="uk-divider-icon">

<ul uk-tab>
    <li><a href="#"><i uk-icon="happy"></i>&nbsp;ただいま栽培中</a></li>
    <li><a href="#"><i uk-icon="album"></i>&nbsp;栽培終了</a></li>
</ul>


<ul class="uk-switcher uk-margin">
    <li>
        {% regroup growingcrop_list by area as area_list %}
        {% for area in area_list %}
        <div class="uk-card uk-card-default uk-card-body">
        {% for growingcrop in area.list %}
        <p>
            <span class="uk-badge">{{area.grouper}}</span>&nbsp;
            <a class="uk-link-text" href="{% url 'vegetablegarden:cropmanagement_list' growingcrop.pk %}">
            <span class="uk-text-bold">{{growingcrop.vegetable}}</span>&nbsp;
            <span class="uk-text-small uk-text-light">{{growingcrop.variety|default:""}}</span>
            </a>
            <br>
            <span class="uk-text-meta">
            {% if growingcrop.seeding_date %}播種日 {{growingcrop.seeding_date|date:"Y-m-d"}}&nbsp;{% endif %}
            {% if growingcrop.planting_date %}植付日 {{growingcrop.planting_date|date:"Y-m-d"}}&nbsp;{% endif %}
            {% if growingcrop.transplanting_date %}移植日 {{growingcrop.transplanting_date|date:"Y-m-d"}}&nbsp;{% endif %}
            {% if growingcrop.harvest_date_start %}収穫開始日 {{growingcrop.harvest_date_start|date:"Y-m-d"}}&nbsp;{% endif %}
            {% if growingcrop.harvest_date_end %}収穫完了日 {{growingcrop.harvest_date_end|date:"Y-m-d"}}{% endif %}            
            </span>
        </p>
        {% endfor %}
        </div>
        {% if not forloop.last %}<br>{% endif %}
        {% endfor %}
    </li>
    <li>
        {% regroup harvestedcrops by area as area_list %}
        {% for area in area_list %}
        <div class="uk-card uk-card-default uk-card-body">
        {% for harvestedcrop in area.list %}
        <p>
            <span class="uk-badge">{{area.grouper}}</span>&nbsp;
            <a class="uk-link-text" href="{% url 'vegetablegarden:cropmanagement_list' harvestedcrop.pk %}">
            <span class="uk-text-bold">{{harvestedcrop.vegetable}}</span>&nbsp;
            <span class="uk-text-small uk-text-light">{{harvestedcrop.variety|default:""}}</span>
            </a>
            <br>
            <span class="uk-text-meta">
            {% if harvestedcrop.seeding_date %}播種日 {{harvestedcrop.seeding_date|date:"Y-m-d"}}&nbsp;{% endif %}
            {% if harvestedcrop.planting_date %}植付日 {{harvestedcrop.planting_date|date:"Y-m-d"}}&nbsp;{% endif %}
            {% if harvestedcrop.transplanting_date %}移植日 {{harvestedcrop.transplanting_date|date:"Y-m-d"}}&nbsp;{% endif %}
            {% if harvestedcrop.harvest_date_start %}収穫開始日 {{harvestedcrop.harvest_date_start|date:"Y-m-d"}}&nbsp;{% endif %}
            {% if harvestedcrop.harvest_date_end %}収穫完了日 {{harvestedcrop.harvest_date_end|date:"Y-m-d"}}{% endif %}            
            </span>
        </p>
        {% endfor %}
        </div>
        {% if not forloop.last %}<br>{% endif %}
        {% endfor %}
    </li>
</ul>
{% endif %}
{% endblock %}